<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <![endif]-->
    <meta name="robots" content="NONE,NOARCHIVE" />
    {% load get_version %}
    <meta name="generator" content="MxLIVE {{ 0|get_version }}" >
	<title>MxLIVE &middot; Lab Info Management System</title>
    <link REL="SHORTCUT ICON" HREF="/static/img/lims.ico">

    <script type="text/javascript" src="/static/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="/static/js/jquery.easing-1.3.pack.js"></script>
	<script type="text/javascript" src="/static/js/jquery.mousewheel-3.0.6.pack.js"></script>
    <script type="text/javascript" src="/static/js/jquery.jgrowl_minimized.js"></script>
    <script type="text/javascript" src="/static/js/jquery.form.js"></script>
    <script type="text/javascript" src="/static/js/jquery.tablednd_0_5.js"></script>
	<script type="text/javascript" src="/static/js/fancybox-1.3.4.clsmin.js"></script>
    <script type="text/javascript" src="/static/js/imm.js"></script>
    
	<script type="text/javascript">
		jQuery(document).ready(function() {
            // initialize browser and add classes to body tag
		    initBrowser();
            initModals();
            initRedirects();
		});
	</script>
    
    {% block stylesheet %}

        <link href='//fonts.googleapis.com/css?family=Alegreya+Sans:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/static/css/imm.css" />
        <link rel="stylesheet" href="/static/css/style.css" />
        <link rel="stylesheet" href="/static/css/jquery.jgrowl.css" />
        <link rel="stylesheet" href="/static/css/jquery.fancybox-1.3.4.css" />
        <link type="text/css" href="/static/css/print.css" rel="stylesheet" media="print">
        <!--[if IE]>
                <link rel="stylesheet" type="text/css" href="/static/css/ie-only.css" />
        <![endif]-->        
    {% endblock %}
    {% block extrastyle %}{% endblock %}
    {% block extra_css %}{% endblock %}

</head>
<body class="{% block bodyclass %}{% endblock %}">
    <div id="main-wrapper">
    <!-- start banner -->
    <div id="header"><div id="banner">
	    <div id="logo" class="redirect" href="/">
		    <h1>Macromolecular Crystallography</h1>
		    <p id="slogan">Laboratory Information Virtual Environment.</p>
	    </div>
        {% if user.is_authenticated %}
        <div id="user-tools">
            Logged-in as <strong>{{user}}</strong> |
            {% if user.is_superuser %}<a href="/admin/">Site Admin</a> | {% endif %}
            <a href="/logout/">Log out</a>
        </div>

    {% endif %}
	</div></div>
    <!-- end banner -->

    <div id="headline">
	    <div class="wrapper">
	        <div class="col-12">
                <div id="content-title">
                {% block headline %}{% endblock %}{% block page_heading %}{% endblock %}
                </div>
                {% block object-tools %}{% endblock %}
            </div>
	    </div>
    </div>
    
    <div id="container">
    {% block activity %}{% endblock %}
    {% if messages %}
        <script>
            {% for msg in messages %}
                jQuery.jGrowl("{{msg|escape|capfirst}}", { life: 4000 });
            {% endfor %}
        </script>
    {% endif %}

    <div id="subcontainer">
    <noscript>
    <div id="no-javascript">
    JavaScript must be enabled for the MxLIVE to function propertly. 
    However, it seems JavaScript is either disabled or not supported by your browser!
    </div>
    </noscript>
{% block content-override %}
    <!-- maincol -->
	<div id="content" class="col-9">
    {% block content %}
        {{ content }}
    {% endblock %}{% block full %}{% endblock %}
    </div>
    <!-- end maincol -->
    <!-- sidebar -->
    <div id="sidebar">
        {% block sidebar %}
            {% include "users/activity_log.html" %}
        {% endblock %}
    </div>
    <!-- end sidebar -->   
{% endblock %}
    </div><!-- end subcontainer -->
    </div><!-- end container -->
    <div class="push"></div>
    </div><!-- end main-wrapper -->
    <!-- footer -->
    <div id="footer">
        {% block footer %}
            <p>&copy;2008-16 Canadian Light Source, Inc.</p>
        {% endblock %}
    </div><!-- end footer -->
{% block script %}
<script>
        
        /* TODO: add generic way to overlay a loading indicator on widgets and datalists. */

        function loadWidgets() {
            jQuery(".widget").each(function(i, widget) {
                //console.log("reloading widgets");
                var $widget = jQuery(widget);
                $widget.find("ul").load($widget.attr("data"), function() {
                    initModals();
                    initRedirects();
                });
            });
        }

        function setupRunlist() {
            jQuery(".runlist-experiment").click(function() {
                var data = window.location.pathname + "container/basic/"+jQuery(this).attr('id')+"/";
                jQuery("#containers").attr("data",data);
                jQuery(".container-widget-title").html(jQuery(this).attr('exp'));
                loadWidgets();
            });
            jQuery(".runlist-project").click(function() {
                var data = window.location.pathname + "container/basic/"+jQuery(this).attr('id')+"/";
                jQuery("#containers").attr("data",data);
                jQuery(".container-widget-title").html(jQuery(this).attr('project'));
                loadWidgets();
            });
        }

        loadWidgets();
    </script>
{% endblock %}
</body>
</html>

