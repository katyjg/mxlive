{% extends "users/base.html" %}
{% load static %}
{% load link_list %}
{% load icons %}

{% block page_heading %}
    <h3 class="text-condensed"> <span class="text-muted"><strong>{{ user.username|upper }}</strong> |</span> Staff </h3>
    <span class="text-muted text-condensed hidden-xs">Start here to manage shipments, load containers on a beamline, view data, and more.</span>
{% endblock %}

{% block pre_js %}
    <script src="{% static 'js/d3.v5.min.js' %}"></script>
    <script src="{% static 'js/d3-selection-multi.v1.min.js' %}"></script>
    <script type="text/javascript" src="{% static "js/mxlive-layouts.min.js" %}"></script>
{% endblock %}

{% block object_tools %}
    <a  href="{% url "access-list" %}">
        {% show_icon label="Remote" icon="ti ti-md ti-rss-alt" %}
    </a>
    <a  href="{% url "user-list" %}">
        {% show_icon label="Accounts" icon="ti ti-md ti-user" %}
    </a>
    <a  href="{% url "session-list" %}">
        {% show_icon label="Sessions" icon="ti ti-md ti-time" %}
    </a>
    <div class="separator"></div>
    <a href="#!"  data-form-link="{% url "new-announcement" %}" title="Create Announcement">
        {% show_icon label="Add Info" icon="ti ti-md ti-announcement" %}
    </a>
{% endblock %}

{% block full %}
    <div class="row">
        <div class="col-12 col-sm-6 col-md-3">
            <div class="card mb-4">
                <div class="card-header p-1 text-center text-wide text-muted"><small class="">BEAMLINES</small></div>
                <div class="list-group list-group-flush list-group-hover">
                {% for am in automounters %}
                    <a href="{% url "beamline-detail" pk=am.beamline.pk %}" class="text-center list-group-item" style="overflow: auto;">
                            <div id="layout-{{ am.container.pk }}" class="layout-lg">
                                <h5 class="text-condensed">
                                    <strong><span class="text-muted">{{ am.beamline.acronym }}</span></strong> | {{ am.container.kind }}
                                </h5>
                                <hr/>
                            </div>
                            {% include "users/entries/container-layout.html" with container=am.container details=False %}
                    </a>
                {% endfor %}
                </div>
            </div>
            <div class="card mb-4">
                <div class="card-header p-1 text-center text-wide text-muted"><small>ADAPTORS</small></div>
                <div class="card-body">
                <div class="row">
                {% for container in containers %}
                {% include "users/entries/container-item.html" %}
                {% endfor %}
                </div>
                </div>
            </div>

        </div>
        <div class="col-12 col-sm-6">
            <div class="card mb-4">
                <div class="card-header p-1 text-center text-wide text-muted"><small>SHIPMENTS</small></div>
                <div class="list-group list-group-flush">
                    {% for shipment, stats in shipments %}
                        {% include "users/entries/shipment-list-item.html" %}
                    {% endfor %}
                        <div class="p-2 list-group-item empty">
                            <a href="#!" data-form-link="{% url "shipment-new" %}" class="d-flex flex-row">
                            <div class="box-status">
                                <div class="text-center text-muted">
                                    <div title="Create a Shipment" class="ti ti-md ti-plus"></div>
                                    <div><small>Start Now</small></div>
                                </div>
                            </div>
                            <div class="pl-3 overflow-ellipsis flex-grow-1 align-self-center">
                                <h4 class="p-0 m-0 text-condensed">Click here to start a new shipment!</h4>
                                <span class="overflow ellipsis">Follow the steps to enter your sample information</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <div class="card mb-4">
                <div class="card-header p-1 text-center text-wide text-muted"><small>ACTIVE SESSIONS</small></div>
                <div class="list-group list-group-flush">
                {% for session, stats in sessions %}
                    {% include "users/entries/session-list-item.html" %}
                {% empty %}
                    <div class="list-group-item empty">
                        No active sessions at the moment.
                    </div>
                {% endfor %}
                </div>
            </div>
        </div>

        <div class="col-12 col-sm-3">
            {% load_announcements %}
        </div>
    </div>
{% endblock %}