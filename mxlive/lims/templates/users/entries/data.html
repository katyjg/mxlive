{% extends "modal/content.html" %}
{% load icons %}
{% load data_server %}
{% load static %}
{% load humanize %}
{% load score_colors %}

{% block modal_size %}modal-lg modal-data{% endblock %}
{% block modal_classes %}data-viewer{% endblock %}
{% block modal_title_tools %}{% endblock %}

{% block modal_title %}
    <span class="text-condensed">
        <span class="text-muted">
            <i class="text-muted ti ti-layout-grid3 {% if "MX" in object.kind or "DATA" in object.kind or "RASTER" in object.kind %}fa-th{% else %}fa-line-chart{% endif %}"></i>
            {% if request.user.is_superuser %}{{ object.project | upper }} | {% endif %}</span>
        <strong>{{ object.name }}</strong>
    </span>
{% endblock %}

{% block modal_body %}
    <small class="row py-2">
            <div class="col-3">
                <strong>Type:</strong><br/>
                <span class="text-muted">{{ object.get_kind_display }} from {{ object.modified|naturalday }}</span><br/>
                <span class="text-muted">{% if object.session %}Session
                    <a href="{% url 'session-detail' object.session.pk %}">{{ object.session.name }}</a>{% else %}
                    Unrecorded Session{% endif %}</span>
            </div>
            <div class="col">
                <strong>Beam:</strong><br/>
                <span class="text-muted">{{ object.beamline }} at {{ object.energy }} keV</span><br/>
                {% if object.beam_size %}<span class="text-muted" title="Beam Size">{{ object.beam_size|floatformat:2 }} &mu;m</span>{% endif %}
            </div>
            <div class="col">
                <strong>Parameters:</strong><br/>
                <span class="text-muted">
                            <span title="Exposure Time">{{ object.exposure_time }}s exposure time</span><br/>
                            <span title="Attenuation">{{ object.attenuation }}% attenuated</span>
                        </span>
            </div>
            <div class="col">
                <strong>Sample:</strong><span class="text-muted"> {% if object.sample %}
                <a href="{% url "sample-detail" object.sample.pk %}">{{ object.sample }}</a>{% else %}
                None{% endif %}</span><br/>
                <strong>Group:</strong><span class="text-muted"> {% if object.sample %}
                <a href="{% url "group-detail" object.sample.group.pk %}">{{ object.sample }}</a>{% else %}
                None{% endif %}</span><br/>
                <strong>Report:</strong><span class="text-muted"> {% for report in object.reports.all %}
                <a href="{% url "report-detail" report.pk %}" title="View {{ report.name }} Report">
                                <span class="badge badge-{{ report.score|label_score }}">{{ report.score|floatformat:2 }}</span>
                            </a>
                {% if not forloop.last %} | {% endif %}{% endfor %}
                        </span>
            </div>
            <div class="col-2 p-0">
                <div class="tools-box float-right">
                {% if object.url %}
                    <a href="{% url 'files-proxy' section='archive' path=object.download_url %}"
                       download="{{ object.name }}.tar.gz" title="Download Full Dataset">
                        {% show_icon label="Download" icon="ti ti-1x ti-download" %}
                    </a>
                {% else %}
                    <span class="text-muted not-allowed" title="Download Not Available">
                        {% show_icon label="Download" icon="ti ti-1x ti-download" %}
                    </span>
                {% endif %}
                </div>
            </div>
    </small>
    <hr class="row mt-0"/>

    {% if "MX" in object.kind or "DATA" in object.kind or "RASTER" in object.kind %}
        {% include "users/entries/data-mx.html" %}
    {% elif "MAD" in object.kind %}
        {% include "users/entries/data-mad.html" %}
    {% elif "XRF" in object.kind %}
        {% include "users/entries/data-xrf.html" %}
    {% endif %}
{% endblock %}