function getUrlParameter(a){var b,c,d=window.location.search.substring(1),e=d.split("&");for(c=0;c<e.length;c++)if(b=e[c].split("="),b[0]===a)return void 0===b[1]||decodeURIComponent(b[1])}function initSampleSpreadsheet(){function a(a){let b=[];$("[data-field='"+a+"']").each(function(){let a=$(this).text();a&&b.includes(a)?$(this).addClass("error"):$(this).removeClass("error"),b.push(a)})}let b=$("#container-spreadsheet");b.on("paste","[contenteditable='true']",function(b){b.preventDefault(),b.stopPropagation();let c=$(this).data("field"),d=!!$(this).data("unique"),e=strip(b.originalEvent.clipboardData.getData("Text")).split(/\r?\n/),f=$(this).parent(),g=f.index();f.nextAll().addBack().each(function(b,f){let g=slugify(e[b]),h=$(f).find("[data-field=\""+c+"\"]");d&&a(c),h.html(g)})}),b.on("click","a.remove-sample.remove",function(){$(this).removeClass("remove text-danger"),$(this).popover("dispose");let b=$(this).closest("tr");b.find("[data-field]").each(function(){let b=$(this).data("field");$(this).html(""),$(this).data("unique")&&a(b)})}),b.on("click","a.remove-sample:not(.remove)",function(){let a=$(this);a.addClass("remove text-danger"),a.popover({content:"click again to confirm"}),a.popover("show"),setTimeout(function(){a.removeClass("remove text-danger"),a.popover("dispose")},3e3)}),b.on("keyup","[contenteditable='true']",function(){let b=$(this).data("field");$(this).data("unique")&&a(b)}),$("#save-spreadsheet").click(function(){let a=[],b=$(this);b.html("<i class=\"ti ti-reload spin\"></i>"),$("tr[data-location]").each(function(){let b={};b.location=$(this).data("location"),$(this).data("sample")&&(b.sample=$(this).data("sample")),$(this).find("[data-field]").each(function(){b[$(this).data("field")]=strip($(this).text())}),a.push(b)}),console.log(a),$.ajax({type:"post",dataType:"json",url:b.data("post-action"),data:{samples:JSON.stringify(a)},beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){a.url?window.location.replace(a.url):window.location.reload()},error:function(){b.shake(),b.html("<i class=\"ti ti-alert\"></i>")}})})}