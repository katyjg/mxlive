function selectOne(a,b){var c=$("input[id$=sample_locations]"),d=$.parseJSON(c.val()),e=$(a).attr("group");if(!e||b===e){$(a).toggleClass("empty").toggleClass("selected");var f=$(a).attr("port"),g=slug($(a).closest("svg").attr("id"));b in d||(d[b]={}),e===b?($(a).attr("group",""),d[b][g]=$.grep(d[b][g],function(a){return a!==f})):($(a).attr("group",b),!(g in d[b])&&(d[b][g]=[]),0>=f.indexOf(d[b][g])&&d[b][g].push(f))}c.val(JSON.stringify(d))}var slug=function(a){let b=$.trim(a);return b.replace(/[^a-z0-9-_]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")};function setInitial(a){$.each(a,function(a,b){for(var c=0;c<=b.length;c++)c>$(".repeat-row").not(".template").length&&$(".add").trigger("click")});let b=$(".repeat-row").not(".template");$.each(a,function(a,c){let d=a.split("_set")[0];$.each(c,function(a,c){let e=$(b[a]).find($(`:input[name="${d}"]`));e.val(c).trigger("change")})}),$(".repeat-row.template :input[data-repeat-enable]").removeAttr("readonly").trigger("change")}function openSelector(a){$("span.group-name").html(a),$("#group-select circle.full[group=\""+a+"\"]").addClass("selected").removeClass("full"),$("#group-select circle").off(),$("#group-select circle").on("click",function(){selectOne(this,a)})}function initShipmentWizard(){function a(){$(".repeat-row:not(.template)").each(function(a,b){$(b).find(".select-alt.select2-hidden-accessible").each(function(){$(this).data("select2")&&$(this).select2("destroy")}),$(b).find("[id]").each(function(b,c){c.id.match(/--\d+$/)?$(c).attr("id",c.id.replace(/--\d+$/,"--"+a)):$(c).attr("id",c.id+"--"+a)}),$(b).find("label[for]").each(function(b,c){$(c).attr("for").match(/--\d+$/)?$(c).attr("for",$(c).attr("for").replace(/--\d+$/,"--"+a)):$(c).attr("for",$(c).attr("for")+"--"+a)}),$(b).find("a[href*=\"--\"]").each(function(b,c){$(c).attr("href").match(/--\d+$/)&&$(c).attr("href",$(c).attr("href").replace(/--\d+$/,"--"+a))}),$(b).find(".select-alt:not(.select2-hidden-accessible)").select2({theme:"bootstrap4"})})}let b="{rowcount}";$(".repeat").each(function(){$(this).find(".select-alt.select2-hidden-accessible").each(function(){$(this).data("select2")&&$(this).select2("destroy")}),$(this).on("click",".safe-remove:not(.remove)",function(){let a=$(this);a.switchClass("btn-warning","btn-danger",100,"fade",function(){a.addClass("remove","text-white"),a.popover({content:"Click again to confirm",placement:"bottom"}),a.popover("show")}),setTimeout(function(){a.popover("dispose"),a.switchClass("btn-danger","btn-warning",100,"fade",function(){a.removeClass("remove","text-white")})},3e3)}),$(this).repeatable_fields({row_count_placeholder:b,row:".repeat-row",container:".repeat-container",wrapper:".repeat-wrapper",after_add:function(c,d){let e=$(c).attr("data-rf-row-count");e++,$("*",d).each(function(){$.each(this.attributes,function(){this.value=this.value.replace(b,e-1)})}),$(c).attr("data-rf-row-count",e),a()},after_remove:function(){a()}}),$(".add").trigger("click"),$(".repeat-wrapper").find(".repeat-container").on("sortupdate",function(){$.each($("input[name$=\"priority\"]"),function(a,b){$(b).val(a)})})})}