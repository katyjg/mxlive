{% if filters %}
    <form id="objlist-search" class="col-xs-12 col-sm-4 pull-left" role="search" action="." method="get">
        <div class="input-group input-group-sm">
            <input name="q" type="text" class="form-control" placeholder="Search" value="{{ view.query|default:'' }}">
            <span class="input-group-btn input-group-sm">
        <button class="btn btn-default" type="submit"><i class="ti ti-search fa-1"></i></button>
      </span>
        </div>
    </form>
    <ul class="filters nav nav-pills pull-left">
        {% for title, spec, selected in filters %}
            <li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><span
                    class="filter-name">{{ title|capfirst }}</span><span class="caret"></span><br/><span
                    class="filter-selected">{{ selected|truncatechars:30 }}</span></a>
                    <ul class="dropdown-menu scrollbox" style="max-height: 60vh;">
                    {% for choice in spec %}
                        <li class="{% if choice.selected %}active{% endif %}" style="max-width: 350px;">
                            <a class="filter overflow ellipsis" href="{{ choice.query_string }}" >{{ choice.display|escape }}</a>
                        </li>
                    {% endfor %}
                    </ul>
            </li>{% endfor %}
    </ul>
    <span class="pull-right text-primary hidden-sm" style="line-height: 2;">
	{{ paginator.count }}&nbsp;{% if total_objects != paginator.count %}/&nbsp;{{ total_objects }}&nbsp;{% endif %}
        item{{ total_objects|pluralize }}
</span>
{% endif %}
<script>
    // Perform search by updating search parameter to keep existing filters
    function updateParam(key, value) {
        key = encodeURI(key);
        value = encodeURI(value);
        var kvp = document.location.search.substr(1).split('&');
        var params = {};
        var new_params = []
        var i = kvp.length;
        var x;
        while (i--) {
            x = kvp[i].split('=');
            if (x[0] == key) {
                x[1] = value
            }
            ;
            if (x[0] == 'page') {
                x[1] = '1'
            }
            ;
        }
        params[key] = value;
        $.each(params, function (key, value) {
            new_params.push(key + '=' + value);
        });
        document.location.search = new_params.join('&');
    }
    $('#objlist-search').submit(function (e) {
        e.preventDefault();
        updateParam('q', $(this).find('[name="q"]').val());
    });
</script>