{% load humanize %}

<div id="view-report" class="hidden modal-content wide"></div>

{% include "lims/tools.html" %}

<h3>{{ object.name }} ({{ object.identity }})</h3>
{% if object.comments %}
	<div>{{object.comments}}</div>
{% endif %}
<img src="/img/constituent.png" style="float:right;clear: right; margin: 0.5em; padding-right: 2em; "/>

<table class="entrysummary" cellpadding="2" cellspacing="0" border="0" width="60%">
	<tr valign="top"><th NOWRAP>Desired Resolution:</th><td>{{object.resolution}}</td></tr>
	<tr valign="top"><th>Delta Angle:</th><td>{{object.delta_angle}}</td></tr>
	<tr valign="top"><th>Multiplicity:</th><td>{{object.multiplicity}}</td></tr>
	<tr valign="top"><th>Angle Range:</th><td>{{object.delta_angle}}</td></tr>
	<tr valign="top"><th>I/Sigma:</th><td>{{object.i_sigma}}</td></tr>
	<tr valign="top"><th>Desired R-factor:</th><td>{{object.r_meas}}</td></tr>
	<tr valign="top"><th>Energy:</th><td>{{object.energy}}</td></tr>
	<tr valign="top"><th>Absorption Edge:</th><td>{{object.absorption_edge}}</td></tr>
</table>

<h3>Associated Crystals</h3>
<img src="/img/samples-crystal.png" style="float:right;clear: right; margin: 0.5em; padding-right: 2em; "/>

{% if object.crystals %}
    <ul class="treeview">
    {% for crystal in object.crystals.all %}
        <li id="{{crystal.id}}" class="crystal draggable-link-parent">
            <a class="crystal" href="{% url lims-crystal-detail crystal.id %}">{{ crystal.name }} ({{ crystal.identity }})</a>
        </li>
    {% endfor %}
    </ul>
{% else %}
    (No crystals have been associated with this experiment).
{% endif %}

<h3>Datasets</h3>
<!-- load Data objects with project and experiment id matches -->
	<table style="width: 100%;">
		<tr>
			<th></th>
			<th>Id</th>
			<th>Name</th>
			<th>Crystal</th>
			<th>Frames</th>
			<th>Total Angle</th>
			<th>Result</th>
		</tr>	
		<!-- TODO: Don't like this implementation. Should use filter instead -->
		{% for data in datasets %}
			<tr class="{% cycle 'odd' 'even' %} link-row">
				<td class="first"></td>
				<td>{{ data.id }}</td>
				<td>{{ data.name }}</td>
				<td>{{ data.crystal }}</td>
				<td>{{ data.num_frames }}</td>
				<td>{{ data.delta_angle }}</td>
				<td></td>
			</tr>
		{% endfor %}
	</table>



<h3>Experiment Results</h3>
<!-- load Result objects with project and experiment id matches -->

    <table style="width: 100%;">
        <tr>
            <th></th>
            <th>Id</th>
            <th>Name</th>
            <th>Crystal</th>
            <th>Score</th>
            <th>Result</th>
            <th>R-Factor</th>
        </tr>
        <!-- TODO: Don't like this implementation. Should use filter instead -->
        {% for result in results %}
			<tr class="{% cycle 'odd' 'even' %} link-row">
				<td class="first"></td>
				<td>{{ result.id }}</td>
				<td>{{ result.name }}</td>
				<td>{{ result.crystal }}</td>
				<td>{{ result.score }}</td>
				<td></td>
				<td></td>
			</tr>
        {% endfor %}
    </table>
