{% load objlist %}
{% load truncate_filters %}
{% ifequal page "shipment" %}
<div id="{{dewar.id}}" 
     class="dewar dewar-detail droppable droppable-add" 
     {% if dewar.is_editable %}accept="container"{% else %}accept=""{% endif %} 
     rel="{% url lims-dewar-detail dewar.id %}">
    <div class="title">
        <p class="dewar droppable droppable-add" 
            {% if dewar.is_editable %}accept="container"{% else %}accept=""{% endif %}  
            rel="{% url lims-dewar-detail dewar.id %}">
            <a class="dewar-title" href="{% url lims-dewar-detail dewar.id %}" title="{{ dewar.name }}">{{ dewar.name|truncate_chars:15 }}</a>
            {% if admin %}{% if dewar.is_receivable %}
            <a class="receive modal-form"
               href="{% url staff-dewar-receive dewar.pk %}?name={{dewar.name}}"
               title="Receive this dewar">&nbsp;</a>{% endif %}{% endif %}
            {% if dewar.shipment.is_editable %}
            <a class="remove"
               rel="{% url lims-dewar-remove dewar.shipment.pk dewar.pk %}" 
               href="#"
               onclick="remove_item(this);"
               title="Remove dewar from shipment">&nbsp;</a>{% endif %}
        </p>        
    </div>
    {% if containers %}
    <ul class="dewar droppable droppable-add" 
     {% if dewar.is_editable %}accept="container"{% else %}accept=""{% endif %}  
     rel="{% url lims-dewar-detail dewar.id %}">
        {% for container in containers %}
            <li class="{{ container.json_dict.type}}">
                <a href="{% url lims-container-detail container.id %}">{{ container.name|truncate_chars:20 }}</a>
                {% if dewar.shipment.is_editable %}
                <a class="remove"
                   rel="{% url lims-dewar-remove-container dewar.pk container.id %}"
                   href="#"
                   onclick="remove_item(this);"
                   title="Remove container from dewar"></a>{% endif %}
            </li>
        {% endfor %}
    </ul>
    {% else %}
        <p class="list-empty">( empty )</p>
    {% endif %}
</div>
{% endifequal %}

{% ifequal page "dewar" %}
<div class="object-list">
    <h3>Containers</h3>
    <table cellspacing="0" cellpadding="2" border="0" width="100%" id="crystal-list-table">
        <thead>
            <tr class="header">
                <th></th>
             	<th>Name</th>
                <th>Barcode</th>
           		<th>Capacity</th>
                <th># of Crystals</th>
                {% if dewar.is_editable %}<th></th>{% endif %}
            </tr>
        </thead>
        <tbody>
            {% for container in containers %}
                <tr class="{% cycle 'odd' 'even'%} link-row"
                    title="Go to Container {{container.pk}}">
                    <td class="redirect"
                        href="{% url lims-container-detail container.pk %}"><div class="{{ container.json_dict.type }}"></div></td>
                    <td class="redirect"
                        href="{% url lims-container-detail container.pk %}">{{ container.name }}</td>
                    <td class="redirect"
                        href="{% url lims-container-detail container.pk %}">
                        {% if container.code %}{{ container.code }}{% else %}Undefined{% endif %}
                    </td>
                    <td class="redirect"
                        href="{% url lims-container-detail container.pk %}">{{ container.capacity }}</td>
                    <td class="redirect"
                        href="{% url lims-container-detail container.pk %}">{{ container.num_crystals }}</td>
                    <td>
                        {% if not admin %}{% if dewar.is_editable %}
                            <a class="remove"
                               rel="{% url lims-dewar-remove-container dewar.pk container.id %}"
                               href="#"
                               onclick="remove_item(this);"
                               title="Remove container from dewar"></a>
                        {% endif %}{% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr><td colspan="20" align="center" class="list-empty">( No containers in this dewar )</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endifequal %}

